var Breakdown,BBTone,breakdown;(function(n){var t=function(){function n(n,t){this._context=n;this.name=t;this.audio=document.createElement("audio");var i=document.createElement("source");i.src="audio/"+t+".mp3";i.type="audio/mp3";this.audio.id="#"+t;this.audio.preload="auto";this.audio.appendChild(i);document.body.appendChild(this.audio);this.source=n.createMediaElementSource(this.audio);this.gain=n.createGain();this.gain.gain.value=this.volume=1;this.source.connect(this.gain)}return Object.defineProperty(n.prototype,"volume",{get:function(){return this.gain.gain.value},set:function(n){this._previousVolume=this.gain.gain.value;this.gain.gain.value=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"muted",{get:function(){return this.volume===0},enumerable:!0,configurable:!0}),n.prototype.mute=function(){console.warn("mute",this.name);var n=this.muted?this._previousVolume||1:0;this.gain.gain.linearRampToValueAtTime(n,this._context.currentTime+2.5)},n}(),i;n.Instrument=t;i=function(){function n(n){this.$scope=n;this.instruments=[];this._playing=!1;this.context=new AudioContext;this.gain=this.context.createGain();this.gain.connect(this.context.destination);this._addInstrument("bongo");this._addInstrument("guira");this._addInstrument("bass");var t=this.instruments[0]}return n.prototype._addInstrument=function(n){var i=new t(this.context,n);i.gain.connect(this.gain);this.instruments.push(i)},Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing},enumerable:!0,configurable:!0}),n.prototype.play=function(){this.context.state==="suspended"&&this.context.resume();this.playing?(this.instruments.forEach(function(n){n.audio.pause()}),this._playing=!1):(this.instruments.forEach(function(n){n.audio.play()}),this._playing=!0)},Object.defineProperty(n.prototype,"volume",{get:function(){return this.gain.gain.value},set:function(n){this._previousVolume=this.gain.gain.value;this.gain.gain.value=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"muted",{get:function(){return this.volume===0},enumerable:!0,configurable:!0}),n.prototype.mute=function(){this.volume=this.muted?this._previousVolume||1:0},n.prototype.$postLink=function(){},n.$inject=["$scope"],n}();n.MainCtrl=i})(Breakdown||(Breakdown={})),function(n){var t=function(){function n(n){var t=this;this.ready=!1;this.instruments=[{name:"bongo"},{name:"guira"},{name:"bass"},{name:"segunda",start:2.1},{name:"requinto",start:1.4,quiet:-15,normal:-5}];angular.forEach(this.instruments,function(n){t[n.name]=new Tone.Player("audio/"+n.name+".mp3").sync().start(n.start||0).toMaster();t[n.name].volume.value=n.normal||0;n.level="normal"});Tone.Buffer.on("load",function(){t.ready=!0;n.$apply()})}return n.prototype.level=function(n,t){n.level=t;switch(n.level){case"mute":this[n.name].mute=!0;break;case"quiet":this[n.name].mute=!1;this[n.name].volume.value=n.quiet||-15;break;case"normal":this[n.name].mute=!1;this[n.name].volume.value=n.normal||0}},n.prototype.rewind=function(){var n=Tone.Transport.state==="started";Tone.Transport.stop();n&&Tone.Transport.start(0)},n.prototype.toggle=function(){Tone.Transport.state==="started"?Tone.Transport.pause():Tone.Transport.start()},n.prototype.$postLink=function(){},n.$inject=["$scope"],n}();n.MainCtrl=t}(BBTone||(BBTone={}));breakdown=angular.module("breakdown",[]);breakdown.controller("mainCtrl",BBTone.MainCtrl);